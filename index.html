<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="GeoDiff: Geometry-Aware Diffusion for Reference-Driven Image Completion.">
  <meta name="keywords" content="Nighttime Dehazing, Prior Learning"> 
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GeoDiff: Geometry-Aware Diffusion for Reference-Driven Image Completion</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">GeoDiff: Geometry-Aware Diffusion for Reference-Driven Image Completion</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><b>NeurIPS 2025</b></span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=KyvHam4AAAAJ&hl=en&oi=ao">Beibei Lin</a>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=v6rq6UsAAAAJ&hl=en&oi=ao">Tingting Chen</a>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=MOD0gv4AAAAJ&hl=en">Robby T. Tan</a>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">National University of Singapore</span>
          </div>

          
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
<!--               <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2403.07408"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
<!--               <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/bb12346/nighthaze_codes"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
<!--               <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="content has-text-centered">
      <img src="./static/images/trailer.png" alt="Qualitative results" style="width:80%; max-width:800px; margin-bottom: 30px;">
    </div>
      <!-- <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video> -->
      <h2 class="subtitle has-text-centered" style="font-size: 16px;">
<!--         <span class="dnerf"> -->
        <p>
        Given a few reference images of the same scene and a target image with missing regions, our method completes the target's missing regions while preserving geometric consistency more effectively than the state-of-the-art Paint-by-Example. 
        Semi-transparent white masks indicate the known, unaltered regions of the target image.
        </p>
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Reference-driven image completion, which restores missing regions in a target view using additional images, is particularly challenging when the target view differs significantly from the references. 
            Existing generative methods rely solely on diffusion priors and, without geometric cues such as camera pose or depth, often produce misaligned or implausible content.
          </p>
          <p>
            We propose GeoDiff, a novel framework that incorporates explicit 3D structural guidance to enforce geometric consistency in the completed regions, setting it apart from prior image-only approaches. 
            GeoDiff introduces two key ideas: conditioning the diffusion process on projected point clouds to infuse geometric information, and applying target-aware masking to guide the model toward relevant reference cues. 
            The framework features a dual-branch diffusion architecture. One branch synthesizes the missing regions from the masked target, while the other extracts geometric features from the projected point cloud. 
            Joint self-attention across branches ensures coherent and accurate completion. 
            To address regions visible in references but absent in the target, we project the target view into each reference to detect occluded areas, which are then masked during training. 
            This target-aware masking directs the model to focus on useful cues, enhancing performance in difficult scenarios. 
            To our knowledge, GeoDiff is the first to tightly couple explicit 3D geometry with diffusion-based image completion in a unified framework.
          </p>
          <p>
            Experiments show that GeoDiff achieves a 17.1% PSNR improvement over state-of-the-art methods, significantly boosting geometric accuracy while maintaining high visual quality.
          </p>

        </div>
      </div>
    </div>
    <!--/ Abstract. -->

  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Pipeline -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Pipeline</h2>
        <div class="content has-text-justified">
           <p>
           Overview of our GeoDiff.
          </p>
           <div class="content has-text-centered">
        <img src="./static/images/overview.png" alt="Framework overview" style="width:80%; max-width:800px; margin-bottom: 30px;">
        </div>
          <p>
             We first construct a point cloud from the reference and target images. 
             During training, target-aware masking selectively masks both the reference images and their projected point clouds to highlight informative regions. 
            These inputs are fed into a dual-branch diffusion model: the target branch encodes the masked image, while the cloud branch processes the projected point cloud. 
            Joint self-attention fuses the two branches, enabling geometric cues to guide content synthesis.
            At inference, the masked target image and its projected point cloud are passed into the finetuned model to complete the missing regions.
          </p>

        </div>
      </div>
    </div>
    <!--/ Pipeline -->

  </div>
</section>
  

  
<section class="section">
  <div class="container is-max-desktop">

   
    <!-- Experiments -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Qualitative and Quantitative Results</h2>

        <!-- Interpolating. -->
        <h3 class="title is-4">Qualitative Results</h3>
        <div class="content has-text-justified">
<!--           <p>
            Here are some qualitative results.
          </p> -->
        </div>
        <div class="content has-text-centered">
        <img src="./static/images/Qualitative.png" alt="Qualitative Results" style="width:80%; max-width:800px; margin-bottom: 30px;">
        </div>
        
        <h3 class="title is-4">Quantitative Results</h3>
        <div class="content has-text-justified">
<!--           <p>
            Here are critical experiment results in zero-shot HOI detection.
          </p> -->
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/Quantitative.png" alt="Quantitative Results" style="width:80%; max-width:800px; margin-bottom: 30px;">
  
        </div>
        <!--/ Re-rendering. -->

      </div>
    </div>
    <!--/ Experiments -->




  </div>
</section>
  
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{lin2024nighthaze,
  title={GeoDiff: Geometry-Aware Diffusion for Reference-Driven Image Completion},
  author={Lin, Beibei and Chen, Tingting and Robby T., Tan},
  journal={The Thirty-Ninth Annual Conference on Neural Information Processing Systems},
  year={2025}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="https://arxiv.org/abs/2403.07408">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://bb12346.github.io" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
